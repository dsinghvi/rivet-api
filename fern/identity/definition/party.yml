# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

imports:
  commons: commons.yml
  game: game.yml
  identity-c: identity-commons.yml
  game-c: game-commons.yml
  party-c: party-commons.yml

types:
  PartySummary:
    properties:
      party_id: uuid
      create_ts: datetime
      activity: party-c.PartyActivity
      external: party-c.PartyExternalLinks
      publicity: PartyPublicity
      party_size: integer
      members: PartyMemberSummaries
      thread_id: uuid

  PartyPublicity:
    properties:
      public: PartyPublicityLevel
      mutual_followers: PartyPublicityLevel
      groups: PartyPublicityLevel

  PartyPublicityLevel:
    enum:
      - name: NONE
        value: none
      - name: VIEW
        value: view
      - name: JOIN
        value: join

  PartyMemberSummaries:
    type: list<PartyMemberSummary>
    docs: A list of party members.

  PartyMemberSummary:
    properties:
      identity: identity-c.IdentityHandle
      is_leader:
        type: boolean
        docs: Whether or not this party member is the leader of the given party.
      join_ts: datetime
      state: PartyMemberState
  
  PartyMemberState: 
    union:
      idle: {} # A party member state denoting that the member is idle. 
      matchmaker_pending: {} # A party member state denoting that the member is currently waiting to start matchmaking. 
      matchmaker_finding_lobby: {} # A party member state denoting that the member is currently searching for a lobby.
      matchmaker_lobby: PartyMemberStateMatchmakerLobby
      
  PartyMemberStateMatchmakerLobby: 
    docs: A party member state denoting that the member is in a lobby.
    properties:
      player_id: uuid

      